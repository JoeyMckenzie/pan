(function(){"use strict";window.__pan=window.__pan||{csrfToken:"%_PAN_CSRF_TOKEN_%",routePrefix:"%_PAN_ROUTE_PREFIX_%",observer:null,clickListener:null,mouseoverListener:null,inertiaStartListener:null},window.__pan.observer&&(window.__pan.observer.disconnect(),window.__pan.observer=null),window.__pan.clickListener&&(document.removeEventListener("click",window.__pan.clickListener),window.__pan.clickListener=null),window.__pan.mouseoverListener&&(document.removeEventListener("mouseover",window.__pan.mouseoverListener),window.__pan.mouseoverListener=null),window.__pan.inertiaStartListener&&(document.removeEventListener("inertia:start",window.__pan.inertiaStartListener),window.__pan.inertiaStartListener=null),function(){const f=e=>{const n=new MutationObserver(e);n.observe(document.body,{childList:!0,subtree:!0,attributes:!0}),window.__pan.observer=n};let r=[],u=null,o=[],a=[],c=[];const _=()=>{if(r.length===0)return;const e=r.slice();r=[],navigator.sendBeacon(`/${window.__pan.routePrefix}/events`,new Blob([JSON.stringify({events:e,_token:window.__pan.csrfToken})],{type:"application/json"}))},w=function(){u&&clearTimeout(u),u=setTimeout(_,1e3)},p=function(e,n){const s=e.target.closest("[data-pan]");if(s===null)return;const i=s.getAttribute("data-pan"),d=s.getAttribute("data-pan-description");if(i!==null){if(n==="hover"){if(a.some(l=>l.name===i))return;a.push({name:i,description:d})}if(n==="click"){if(c.some(l=>l.name===i))return;c.push({name:i,description:d})}r.push({type:n,name:i,description:d}),w()}},m=function(){document.querySelectorAll("[data-pan]").forEach(n=>{if(n.checkVisibility!==void 0&&!n.checkVisibility())return;const t=n.getAttribute("data-pan"),s=n.getAttribute("data-pan-description");t!==null&&(o.some(i=>i.name===t)||(o.push({name:t,description:s}),r.push({type:"impression",name:t,description:s})))}),w()};f(function(){o.forEach(({name:e})=>{document.querySelector(`[data-pan='${e}']`)===null&&(o=o.filter(({name:t})=>t!==e),a=a.filter(({name:t})=>t!==e),c=c.filter(({name:t})=>t!==e))}),m()}),window.__pan.clickListener=e=>p(e,"click"),document.addEventListener("click",window.__pan.clickListener),window.__pan.mouseoverListener=e=>p(e,"hover"),document.addEventListener("mouseover",window.__pan.mouseoverListener),window.__pan.inertiaStartListener=e=>{o=[],a=[],c=[],m()},document.addEventListener("inertia:start",window.__pan.inertiaStartListener),window.__pan.beforeUnloadListener=function(e){r.length!==0&&_()},window.addEventListener("beforeunload",window.__pan.beforeUnloadListener)}()})();
